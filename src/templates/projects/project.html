{% extends "layout.html" %}
{% block head %}
    <title>{{name}}</title>
    <link href='https://fonts.googleapis.com/css?family=Montserrat|IBM+Plex+Mono' rel='stylesheet'>
{% endblock %}
{% block style %}
    a.projects-sidenav-active {
        background-color: #ff0800 !important;
    }

    #title {
        text-align: center;
        font-family: Montserrat;
    }

    #project-title-bar > * {
        display: inline;
    }

    button.edit-button {
        vertical-align: super;
        padding: 0;
        border: 0;
        background-color: transparent;
        cursor: pointer;
    }

    #project-title-bar > button.right {
        float: right;
        border: 1px solid rgba(27,31,35,.15);
        padding: 5px 10px;
        border-radius: 7px;
        margin: 4px 0 0 10px;
        font-size: 15px;
        background-color: white;
        cursor: pointer;
    }

    #project-title-bar > button.right:hover {
        background-color: rgba(27,31,35,.15);
    }

    hr {
        height: 1px;
        border-width: 0;
        background-color: #d1d5da;
        margin: 16px 0;
    }

    #git-log {
        width: 35%;
        float: right;
    }

    #git-log > h4 {
        text-align: center;
        margin: 4px 0 0;
        font-family: Nimbus Sans;
    }

    #git-log > div {
        height: calc(100vh - 188px);
        overflow: scroll;
    }

    #git-log > div > p {
        font-family: IBM Plex Mono;
        white-space: nowrap;
    }

    i.fa.fa-star, i.fa.fa-star-o {
        color: #ffd700;
    }
{% endblock %}
{% block content %}
    <div id="project-title-bar">
        <!--<i class="fa fa-code" style="font-size: 32px;"></i>-->
        <h1 id="title">{{name}}</h1>
        <button class="edit-button"><i class="fa fa-pencil"></i></button>
        <button class="right" onclick="toggleArchive(this);">
            <i class="fa fa-archive"></i>
            {% if archived %}
                Unarchive
            {% else %}
                Archive
            {% endif %}
        </button>
        <button class="right" onclick="toggleStar(this);">
            {% if starred %}
                <i class="fa fa-star"></i>
                Unstar
            {% else %}
                <i class="fa fa-star-o"></i>
                Star
            {% endif %}
        </button>
    </div>
    <hr>
    <div style="display: inline-block;"><p>Main git content</p></div>
    <div id="git-log">
        <h4>Commit Log</h4>
        <hr style="margin-bottom: 0;">
        <div>
            <p>{{ git_log|safe }}</p>
        </div>
    </div>
    <script>
        function toggleArchive(archiveButton) {
            if(archiveButton.innerText === ' Archive') {
                // Archive
                archiveButton.innerHTML = '<i class="fa fa-archive"></i> Unarchive';
                let xhr = new XMLHttpRequest();
                xhr.open("POST", window.location.pathname, true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.send('archived=true');
            }
            else {
                // Unarchive
                archiveButton.innerHTML = '<i class="fa fa-archive"></i> Archive';
                let xhr = new XMLHttpRequest();
                xhr.open("POST", window.location.pathname, true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.send('archived=false');
            }
        }

        function toggleStar(starButton) {
            if(starButton.innerText === ' Star') {
                // Star
                starButton.innerHTML = '<i class="fa fa-star"></i> Unstar';
                let xhr = new XMLHttpRequest();
                xhr.open("POST", window.location.pathname, true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.send('starred=true');
            }
            else {
                // Unarchive
                starButton.innerHTML = '<i class="fa fa-star-o"></i> Star';
                let xhr = new XMLHttpRequest();
                xhr.open("POST", window.location.pathname, true);
                xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                xhr.send('starred=false');
            }
        }
    </script>
{% endblock %}